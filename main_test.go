package main

import (
	"crypto/ecdsa"
	"crypto/elliptic"
	"math/big"
	"os"
	"testing"
)

func TestMain(m *testing.M) {
	// add test issuer/key from specification
	registerIssuer("did:web:nzcp.covid19.health.nz")
	registerPublicKey(
		"did:web:nzcp.covid19.health.nz#key-1",
		&ecdsa.PublicKey{
			Curve: elliptic.P256(),
			X: big.NewInt(0).SetBytes([]byte{
				0xcd, 0x14, 0x7e, 0x5c, 0x6b, 0x02, 0xa7, 0x5d,
				0x95, 0xbd, 0xb8, 0x2e, 0x8b, 0x80, 0xc3, 0xe8,
				0xee, 0x9c, 0xaa, 0x68, 0x5f, 0x3e, 0xe5, 0xcc,
				0x86, 0x2d, 0x4e, 0xc4, 0xf9, 0x7c, 0xef, 0xad,
			}),
			Y: big.NewInt(0).SetBytes([]byte{
				0x22, 0xfe, 0x52, 0x53, 0xa1, 0x6e, 0x5b, 0xe4,
				0xd1, 0x62, 0x1e, 0x7f, 0x18, 0xea, 0xc9, 0x95,
				0xc5, 0x7f, 0x82, 0x91, 0x7f, 0x1a, 0x91, 0x50,
				0x84, 0x23, 0x83, 0xf0, 0xb4, 0xa4, 0xdd, 0x3d,
			}),
		},
	)

	os.Exit(m.Run())
}
